(this.webpackJsonpchat=this.webpackJsonpchat||[]).push([[0],{45:function(e,t,n){},50:function(e,t,n){"use strict";n.r(t);var c=n(15),s=n.n(c),a=n(39),r=n.n(a),i=(n(45),n(0)),o=n.n(i),l=n(1),u=n(13),d=n(20),j=(n(30),n(28)),b=n(11),h=function(e){var t=e.onClick,n=void 0===t?null:t,c=e.text,s=void 0===c?null:c;return Object(b.jsx)("div",{children:Object(b.jsx)("button",{onClick:n,children:s})})},p=n(24),O=(n(37),n(52)),f=function(e){var t="";return e&&(t=(t=Object(O.a)(e,new Date)).charAt(0).toUpperCase()+t.slice(1)),t},m=function(e){var t=e.createdAt,n=void 0===t?null:t,c=e.text,s=void 0===c?"":c,a=e.nickname,r=void 0===a?"":a,i=e.photoURL,o=void 0===i?"":i;return s?Object(b.jsxs)("div",{className:"singleMessage",children:[o&&Object(b.jsx)("div",{className:"one",children:Object(b.jsx)("img",{src:o,alt:"Avatar",className:"userPic",width:40,height:40})}),r&&(null===n||void 0===n?void 0:n.seconds)&&Object(b.jsxs)("div",{className:"two",children:[Object(b.jsx)("span",{className:"msgName",children:r}),Object(b.jsx)("span",{className:"msgTime",children:f(new Date(1e3*n.seconds))})]}),Object(b.jsx)("div",{className:"three",children:Object(b.jsx)("p",{children:s})})]}):null},x=function(e){var t=e.user,n=void 0===t?null:t,s=Object(c.useState)([]),a=Object(u.a)(s,2),r=a[0],i=a[1],h=Object(c.useState)(""),O=Object(u.a)(h,2),f=O[0],x=O[1],v=d.a.firestore(),g=n.uid,k=n.photoURL;Object(c.useEffect)((function(){if(v)return v.collection("messages").orderBy("createdAt").limit(100).onSnapshot((function(e){var t=e.docs.map((function(e){return Object(p.a)(Object(p.a)({},e.data()),{},{id:e.id})}));i(t)}))}),[v]);var N=function(){var e=Object(l.a)(o.a.mark((function e(t){var n,c,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,v.collection("users").doc(g).get();case 3:return n=e.sent,e.next=6,n.data().blocked;case 6:return c=e.sent,e.next=9,n.data().nickname;case 9:s=e.sent,console.log("blocked: ",c),console.log("nickname: ",s),v&&(c?console.log("user is blocked so message didnt send"):v.collection("messages").add({text:f,createdAt:d.a.firestore.FieldValue.serverTimestamp(),uid:g,nickname:s,photoURL:k}),f.includes("corn")&&w()),x("");case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("blocked lmao"),e.next=3,Object(j.c)(Object(j.a)(v,"users",g),{blocked:!0});case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(b.jsxs)("div",{children:[Object(b.jsxs)("div",{className:"chat",children:[Object(b.jsx)("h2",{children:"Welcome!"}),Object(b.jsx)("p",{id:"welcomeText",children:"This is the start of the channel."}),Object(b.jsx)("ul",{children:r.map((function(e){return Object(b.jsx)("li",{onClick:function(){return function(e){console.log("You clicked on a message: '".concat(e.text,"'\n...but this feature isn't implemented yet :("))}(e)},children:Object(b.jsx)(m,Object(p.a)({},e))},e.id)}))})]}),Object(b.jsx)("div",{className:"sendMessage",children:Object(b.jsxs)("form",{onSubmit:N,children:[Object(b.jsx)("input",{type:"text",value:f,onChange:function(e){x(e.target.value)},placeholder:"Message"}),Object(b.jsx)("input",{type:"submit",disable:(!f).toString(),className:"hideThis"})]})})]})},v=function(e){var t=e.user,n=void 0===t?null:t,s=e.stateChanger,a=d.a.firestore(),r=Object(c.useState)(""),i=Object(u.a)(r,2),o=i[0],l=i[1];return Object(b.jsx)("div",{className:"modal",children:Object(b.jsxs)("div",{className:"modal-content",children:[Object(b.jsx)("span",{className:"close",onClick:function(){return s()},children:"\xd7"}),Object(b.jsx)("p",{children:"This is where the user will be able to modify their profile."}),Object(b.jsxs)("form",{onSubmit:function(e){e.preventDefault(),a.collection("users").doc(n.uid).update({nickname:o}),s()},children:[Object(b.jsx)("label",{children:"Change nickname"}),Object(b.jsx)("input",{type:"text",value:o,onChange:function(e){l(e.target.value)}}),Object(b.jsx)("button",{type:"submit",children:"Update"}),Object(b.jsx)("label",{children:"Change picture: coming soon"})]})]})})},g=function(){var e=Object(c.useState)([]),t=Object(u.a)(e,2),n=t[0],s=t[1],a=d.a.firestore();return Object(c.useEffect)((function(){if(a)return a.collection("users").onSnapshot((function(e){var t=e.docs.map((function(e){return Object(p.a)(Object(p.a)({},e.data()),{},{id:e.id})}));s(t),console.log(t)}))}),[a]),Object(b.jsxs)("div",{className:"userList",children:[Object(b.jsx)("h2",{children:"Users"}),n.map((function(e){return Object(b.jsxs)("div",{className:"userListUser",children:[Object(b.jsx)("img",{src:e.photoURL,alt:"Avatar",className:"userPic",width:40,height:40}),Object(b.jsx)("span",{children:e.nickname})]},e.id)}))]})};d.a.initializeApp({apiKey:"AIzaSyBKALmfA6So_nIi5lPTm279CAPWfN_TLMg",authDomain:"corddisc-firetrack.firebaseapp.com",projectId:"corddisc-firetrack",storageBucket:"corddisc-firetrack.appspot.com",messagingSenderId:"1070889245935",appId:"1:1070889245935:web:77d63004606761222d4f1a"});var k=d.a.auth(),N=function(){var e=Object(c.useState)(!0),t=Object(u.a)(e,2),n=t[0],s=t[1],a=Object(c.useState)(!1),r=Object(u.a)(a,2),i=r[0],p=r[1],O=Object(c.useState)((function(){return k.currentUser})),f=Object(u.a)(O,2),m=f[0],N=f[1],w=d.a.firestore();Object(c.useEffect)((function(){return k.onAuthStateChanged((function(e){N(e||!1),n&&s(!1)}))}),[n]);var S=function(){var e=Object(l.a)(o.a.mark((function e(){var t,n,c,s,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new d.a.auth.GoogleAuthProvider,k.useDeviceLanguage(),e.prev=2,e.next=5,d.a.auth().signInWithPopup(t);case 5:return n=e.sent,c=n.user,console.log(c),e.next=10,d.a.firestore().collection("users").get();case 10:if(s=e.sent,a=s.docs.map((function(e){return e.id})),console.log(a),a.includes(c.uid)){e.next=16;break}return e.next=16,Object(j.b)(Object(j.a)(w,"users",c.uid),{nickname:"New user",photoURL:c.photoURL,blocked:!1});case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(2),console.log(e.t0.message);case 21:case"end":return e.stop()}}),e,null,[[2,18]])})));return function(){return e.apply(this,arguments)}}(),C=function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{k.signOut()}catch(t){console.log(t.message)}case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(b.jsx)("div",{children:m?Object(b.jsxs)("div",{className:"container",children:[Object(b.jsxs)("div",{className:"placeholderdiv",children:[Object(b.jsx)("h1",{children:"placeholder text"}),Object(b.jsx)(x,{user:m}),Object(b.jsx)(h,{className:"but",onClick:function(){return p(!i)},text:"User"}),i&&Object(b.jsx)(v,{user:m,stateChanger:p}),Object(b.jsx)(h,{className:"but",onClick:C,text:"Sign out"})]}),Object(b.jsx)(g,{})]}):Object(b.jsxs)("div",{className:"container2",children:[Object(b.jsx)("h1",{children:"Hey."}),Object(b.jsx)("h2",{children:"I'm making my own realtime chat application."}),Object(b.jsx)(h,{onClick:S,text:"Sign in with Google"})]})})},w=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,53)).then((function(t){var n=t.getCLS,c=t.getFID,s=t.getFCP,a=t.getLCP,r=t.getTTFB;n(e),c(e),s(e),a(e),r(e)}))};r.a.render(Object(b.jsx)(s.a.StrictMode,{children:Object(b.jsx)(N,{})}),document.getElementById("root")),w()}},[[50,1,2]]]);
//# sourceMappingURL=main.d77e3da5.chunk.js.map